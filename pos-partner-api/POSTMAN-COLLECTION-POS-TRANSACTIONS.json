{
  "info": {
    "name": "Same Day Solution â€” POS Partner API",
    "description": "Enterprise POS Transaction API for B2B Partners.\n\n## Authentication\nEvery authenticated request requires 3 headers:\n- `x-api-key` â€” Your public API key\n- `x-signature` â€” HMAC-SHA256 signature\n- `x-timestamp` â€” Current Unix timestamp (ms)\n\nSignature formula:\n```\nHMAC_SHA256(api_secret, JSON.stringify(body) + timestamp)\n```\nFor GET requests (no body): `HMAC_SHA256(api_secret, '' + timestamp)`\n\n## Setup\n1. Set `api_key` and `api_secret` in Collection Variables\n2. Pre-request scripts auto-generate signature\n3. All requests are ready to fire\n\n## Security\n- IP Whitelisting enforced (contact admin)\n- Timestamp tolerance: 5 minutes\n- HTTPS required in production\n- Rate limited: 100 req/min",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "2.0.0"
  },
  "auth": {
    "type": "noauth"
  },
  "variable": [
    { "key": "base_url", "value": "https://api.samedaysolution.in", "type": "string" },
    { "key": "api_key", "value": "pk_live_YOUR_API_KEY_HERE", "type": "string" },
    { "key": "api_secret", "value": "sk_live_YOUR_API_SECRET_HERE", "type": "string" },
    { "key": "last_export_job_id", "value": "", "type": "string", "description": "Auto-saved from export job creation. Used by 'Check Export Status' request." }
  ],
  "item": [
    {
      "name": "ðŸ”“ Public",
      "description": "No authentication required",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/pos-health",
              "host": ["{{base_url}}"],
              "path": ["pos-health"]
            },
            "description": "Check if the POS Partner API is running.\n\nNo authentication needed.\n\n**Expected Response:**\n```json\n{\n  \"status\": \"healthy\",\n  \"service\": \"pos-partner-api\",\n  \"timestamp\": \"2026-02-17T10:00:00.000Z\",\n  \"database\": { \"status\": \"healthy\" }\n}\n```"
          },
          "response": [
            {
              "name": "200 â€” Healthy",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"status\": \"healthy\",\n  \"service\": \"pos-partner-api\",\n  \"version\": \"1.0.0\",\n  \"timestamp\": \"2026-02-17T10:00:00.000Z\",\n  \"uptime\": 86400,\n  \"database\": {\n    \"status\": \"healthy\",\n    \"latency_ms\": 12\n  }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "ðŸ” Partner Authenticated",
      "description": "All requests require `x-api-key`, `x-signature`, and `x-timestamp` headers.\n\nThe pre-request script automatically calculates the HMAC signature.",
      "item": [
        {
          "name": "Get POS Transactions",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "// â”€â”€ Auto-generate HMAC Signature â”€â”€",
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "const placeholderKey = 'pk_live_YOUR_API_KEY_HERE'",
                  "const placeholderSecret = 'sk_live_YOUR_API_SECRET_HERE'",
                  "",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === placeholderKey) {",
                  "  throw new Error('Please set api_key in Collection Variables (or Environment Variables).\\n\\nSteps:\\n1. Click on collection name â†’ Variables tab\\n2. Set api_key = pk_live_your_actual_key\\n3. Set api_secret = sk_live_your_actual_secret\\n4. Click Save');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === placeholderSecret) {",
                  "  throw new Error('Please set api_secret in Collection Variables (or Environment Variables).\\n\\nSteps:\\n1. Click on collection name â†’ Variables tab\\n2. Set api_key = pk_live_your_actual_key\\n3. Set api_secret = sk_live_your_actual_secret\\n4. Click Save');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "",
                  "// Parse the raw body",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "const signaturePayload = JSON.stringify(body) + timestamp;",
                  "",
                  "// HMAC-SHA256 signature using crypto-js (Postman compatible)",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "",
                  "// Set headers",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });",
                  "",
                  "console.log('âœ“ Signature generated:', signature.substring(0, 16) + '...');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has transactions array', function() {",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.success).to.be.true;",
                  "  pm.expect(json.data).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Response has pagination', function() {",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.pagination).to.be.an('object');",
                  "  pm.expect(json.pagination).to.have.property('total_records');",
                  "});",
                  "",
                  "pm.test('Transactions include card_classification', function() {",
                  "  const json = pm.response.json();",
                  "  if (json.data && json.data.length > 0) {",
                  "    json.data.forEach(function(txn) {",
                  "      pm.expect(txn).to.have.property('card_classification');",
                  "      // card_classification can be a string or null",
                  "      if (txn.card_classification !== null) {",
                  "        pm.expect(txn.card_classification).to.be.a('string');",
                  "      }",
                  "    });",
                  "  }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-api-key", "value": "{{api_key}}", "description": "Your public API key (auto-set by pre-request script)" },
              { "key": "x-signature", "value": "auto-generated", "description": "HMAC-SHA256 signature (auto-set by pre-request script)" },
              { "key": "x-timestamp", "value": "auto-generated", "description": "Unix timestamp in ms (auto-set by pre-request script)" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"date_from\": \"2026-02-01T00:00:00.000Z\",\n  \"date_to\": \"2026-02-28T23:59:59.999Z\",\n  \"status\": null,\n  \"terminal_id\": null,\n  \"payment_mode\": null,\n  \"settlement_status\": null,\n  \"page\": 1,\n  \"page_size\": 50\n}",
              "options": {
                "raw": { "language": "json" }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/partner/pos-transactions",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-transactions"]
            },
            "description": "Retrieve POS transactions for your assigned terminals.\n\n### Request Body Parameters\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `date_from` | ISO 8601 | âœ… Yes | Start date (max 90 days range) |\n| `date_to` | ISO 8601 | âœ… Yes | End date |\n| `status` | String | No | `AUTHORIZED`, `CAPTURED`, `FAILED`, `REFUNDED`, `VOIDED` |\n| `terminal_id` | String | No | Filter by TID |\n| `payment_mode` | String | No | `CARD`, `UPI`, `NFC` |\n| `settlement_status` | String | No | `PENDING`, `SETTLED`, `FAILED` |\n| `page` | Integer | No | Page number (default: 1) |\n| `page_size` | Integer | No | Records per page (default: 50, max: 100) |\n\n### Authentication Headers\n| Header | Description |\n|--------|-------------|\n| `x-api-key` | Your public API key |\n| `x-signature` | `HMAC_SHA256(api_secret, JSON.stringify(body) + timestamp)` |\n| `x-timestamp` | Current Unix timestamp in milliseconds |\n\n### Response Fields (per transaction)\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | String | Internal transaction ID |\n| `razorpay_txn_id` | String | Razorpay transaction ID |\n| `external_ref` | String | External reference number |\n| `terminal_id` | String | Terminal ID (TID) |\n| `amount` | Integer | Amount in paisa |\n| `status` | String | `AUTHORIZED`, `CAPTURED`, `FAILED`, `REFUNDED`, `VOIDED` |\n| `rrn` | String | Retrieval Reference Number |\n| `card_brand` | String | `VISA`, `MasterCard`, `RUPAY`, `Diners Club` |\n| `card_type` | String | `CREDIT`, `DEBIT` |\n| `card_number` | String | Masked card number (e.g. `4862-69XX-XXXX-3667`) |\n| `issuing_bank` | String | Card issuing bank (e.g. `HDFC`, `SBI`, `AXIS`) |\n| `card_classification` | String | Card tier/classification from issuing bank. Possible values: `PLATINUM`, `GOLD`, `STANDARD`, `CLASSIC`, `SIGNATURE`, `BUSINESS`, `TITANIUM`, `INFINITE`, `CORPORATE`, `PREPAID`, `ELECTRON`, `MPL`, `MPG`, `MPL - Platinum`, `Mastercard World`, `Visa Class`, `WORLD CARD`, `WORLD FOR`, `Rewards`, `Select`, `ANY`, `Fpaydefaul`, `NULL`. May be `null` if not available. |\n| `payment_mode` | String | `CARD`, `UPI`, `NFC` |\n| `settlement_status` | String | `PENDING`, `SETTLED`, `FAILED` |\n| `device_serial` | String | POS device serial number |\n| `customer_name` | String | Consumer/cardholder name |\n| `payer_name` | String | Payer name |\n| `username` | String | Operator/agent username |\n| `txn_type` | String | Transaction type (e.g. `CHARGE`) |\n| `auth_code` | String | Authorization code from card issuer |\n| `mid` | String | Merchant ID (e.g. `IDZ551`) |\n| `currency` | String | Currency code (e.g. `INR`) |\n| `receipt_url` | String | Customer receipt URL |\n| `settled_on` | String | Settlement date/time (ISO 8601) |\n| `posting_date` | String | Posting date (ISO 8601) |\n| `txn_time` | String | Transaction time (ISO 8601) |\n| `created_at` | String | Record creation time (ISO 8601) |\n| `retailer_code` | String | Retailer code |\n| `retailer_name` | String | Retailer name |\n| `merchant_name` | String | Merchant name |"
          },
          "response": [
            {
              "name": "200 â€” Transactions Found",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n      \"razorpay_txn_id\": \"260217042251974E883523117\",\n      \"external_ref\": \"EZ202602171503118508\",\n      \"terminal_id\": \"96192751\",\n      \"amount\": 285000,\n      \"status\": \"CAPTURED\",\n      \"rrn\": \"000000000070\",\n      \"card_brand\": \"VISA\",\n      \"card_type\": \"CREDIT\",\n      \"card_number\": \"4862-69XX-XXXX-3667\",\n      \"issuing_bank\": \"HDFC\",\n      \"card_classification\": \"PLATINUM\",\n      \"payment_mode\": \"CARD\",\n      \"settlement_status\": \"SETTLED\",\n      \"device_serial\": \"2841155771\",\n      \"customer_name\": \"MR SHREYAS T\",\n      \"payer_name\": \"MR SHREYAS T\",\n      \"username\": \"0096192751\",\n      \"txn_type\": \"CHARGE\",\n      \"auth_code\": \"007115\",\n      \"mid\": \"IDZ551\",\n      \"currency\": \"INR\",\n      \"receipt_url\": \"http://eze.cc/RZPPOS/t/a/DB120049\",\n      \"settled_on\": \"2026-01-01T01:00:00.000Z\",\n      \"posting_date\": \"2026-01-01T00:12:00.000Z\",\n      \"merchant_name\": \"Same Day Solution\",\n      \"txn_time\": \"2026-01-01T00:12:00.000Z\",\n      \"created_at\": \"2026-01-01T00:12:01.000Z\",\n      \"retailer_code\": \"RET001\",\n      \"retailer_name\": \"Example Retailer\"\n    }\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"page_size\": 50,\n    \"total_records\": 1,\n    \"total_pages\": 1,\n    \"has_next\": false,\n    \"has_prev\": false\n  },\n  \"summary\": {\n    \"total_transactions\": 1,\n    \"total_amount_paisa\": 285000,\n    \"total_amount_rupees\": \"2850.00\",\n    \"authorized_count\": 0,\n    \"captured_count\": 1,\n    \"failed_count\": 0,\n    \"refunded_count\": 0,\n    \"captured_amount_paisa\": 285000,\n    \"captured_amount_rupees\": \"2850.00\",\n    \"terminal_count\": 1\n  }\n}"
            },
            {
              "name": "400 â€” Bad Request",
              "status": "Bad Request",
              "code": 400,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"BAD_REQUEST\",\n    \"message\": \"date_from and date_to are required\"\n  }\n}"
            },
            {
              "name": "401 â€” Unauthorized (Invalid API Key)",
              "status": "Unauthorized",
              "code": 401,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"UNAUTHORIZED\",\n    \"message\": \"Invalid API key\"\n  }\n}"
            },
            {
              "name": "401 â€” Unauthorized (IP Blocked)",
              "status": "Unauthorized",
              "code": 401,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"UNAUTHORIZED\",\n    \"message\": \"IP address not authorized\"\n  }\n}"
            },
            {
              "name": "401 â€” Unauthorized (Expired Timestamp)",
              "status": "Unauthorized",
              "code": 401,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"UNAUTHORIZED\",\n    \"message\": \"Request timestamp expired. Must be within 300 seconds of server time.\"\n  }\n}"
            },
            {
              "name": "429 â€” Rate Limited",
              "status": "Too Many Requests",
              "code": 429,
              "header": [
                { "key": "Content-Type", "value": "application/json" },
                { "key": "Retry-After", "value": "60" }
              ],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"RATE_LIMIT_EXCEEDED\",\n    \"message\": \"Too many requests. Please retry after 60 seconds.\"\n  }\n}"
            }
          ]
        },
        {
          "name": "Get Transactions â€” Filter by TID",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "const signaturePayload = JSON.stringify(body) + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-api-key", "value": "{{api_key}}" },
              { "key": "x-signature", "value": "auto-generated" },
              { "key": "x-timestamp", "value": "auto-generated" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"date_from\": \"2026-02-17T00:00:00.000Z\",\n  \"date_to\": \"2026-02-17T23:59:59.999Z\",\n  \"terminal_id\": \"29196333\",\n  \"page\": 1,\n  \"page_size\": 20\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{base_url}}/api/partner/pos-transactions",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-transactions"]
            },
            "description": "Filter transactions by a specific Terminal ID (TID) for today."
          },
          "response": [
            {
              "name": "200 â€” Transactions by TID",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"b2c3d4e5-f6a7-8901-bcde-f12345678901\",\n      \"razorpay_txn_id\": \"260217093324974E883523117\",\n      \"external_ref\": \"EZ202602171503118508\",\n      \"terminal_id\": \"29196333\",\n      \"amount\": 1500000,\n      \"status\": \"CAPTURED\",\n      \"rrn\": \"000000000052\",\n      \"card_brand\": \"VISA\",\n      \"card_type\": \"CREDIT\",\n      \"card_number\": \"4147-52XX-XXXX-7416\",\n      \"issuing_bank\": \"INDUSIND\",\n      \"card_classification\": \"SIGNATURE\",\n      \"payment_mode\": \"CARD\",\n      \"settlement_status\": \"SETTLED\",\n      \"device_serial\": \"2841154268\",\n      \"customer_name\": \"RABINDRA KUMAR\",\n      \"payer_name\": \"RABINDRA KUMAR\",\n      \"username\": \"0029196333\",\n      \"txn_type\": \"CHARGE\",\n      \"auth_code\": \"130629\",\n      \"mid\": \"IDZ579\",\n      \"currency\": \"INR\",\n      \"receipt_url\": \"http://eze.cc/RZPPOS/t/a/3AF88A44\",\n      \"settled_on\": \"2026-02-17T23:00:00.000Z\",\n      \"posting_date\": \"2026-02-17T11:18:00.000Z\",\n      \"merchant_name\": \"Same Day Solution\",\n      \"txn_time\": \"2026-02-17T11:18:00.000Z\",\n      \"created_at\": \"2026-02-17T11:18:01.000Z\",\n      \"retailer_code\": \"RET002\",\n      \"retailer_name\": \"Example Retailer 2\"\n    },\n    {\n      \"id\": \"c3d4e5f6-a7b8-9012-cdef-123456789012\",\n      \"razorpay_txn_id\": \"260217113024525R010024087\",\n      \"external_ref\": \"EZ202602171530118610\",\n      \"terminal_id\": \"29196333\",\n      \"amount\": 4741000,\n      \"status\": \"CAPTURED\",\n      \"rrn\": \"000000000222\",\n      \"card_brand\": \"RUPAY\",\n      \"card_type\": \"CREDIT\",\n      \"card_number\": \"6529-03XX-XXXX-0290\",\n      \"issuing_bank\": \"SBI\",\n      \"card_classification\": \"PREPAID\",\n      \"payment_mode\": \"CARD\",\n      \"settlement_status\": \"SETTLED\",\n      \"device_serial\": \"2841154268\",\n      \"customer_name\": \"MADAN LAL\",\n      \"payer_name\": \"MADAN LAL\",\n      \"username\": \"0029196333\",\n      \"txn_type\": \"CHARGE\",\n      \"auth_code\": \"R57618\",\n      \"mid\": \"IDZ579\",\n      \"currency\": \"INR\",\n      \"receipt_url\": \"http://eze.cc/RZPPOS/t/a/CCB6D380\",\n      \"settled_on\": \"2026-02-17T23:00:00.000Z\",\n      \"posting_date\": \"2026-02-17T13:02:00.000Z\",\n      \"merchant_name\": \"Same Day Solution\",\n      \"txn_time\": \"2026-02-17T13:02:00.000Z\",\n      \"created_at\": \"2026-02-17T13:02:01.000Z\",\n      \"retailer_code\": \"RET002\",\n      \"retailer_name\": \"Example Retailer 2\"\n    }\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"page_size\": 20,\n    \"total_records\": 2,\n    \"total_pages\": 1,\n    \"has_next\": false,\n    \"has_prev\": false\n  },\n  \"summary\": {\n    \"total_transactions\": 2,\n    \"total_amount_paisa\": 6241000,\n    \"total_amount_rupees\": \"62410.00\",\n    \"authorized_count\": 0,\n    \"captured_count\": 2,\n    \"failed_count\": 0,\n    \"refunded_count\": 0,\n    \"captured_amount_paisa\": 6241000,\n    \"captured_amount_rupees\": \"62410.00\",\n    \"terminal_count\": 1\n  }\n}"
            }
          ]
        },
        {
          "name": "Get Transactions â€” Filter by Status",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "const signaturePayload = JSON.stringify(body) + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-api-key", "value": "{{api_key}}" },
              { "key": "x-signature", "value": "auto-generated" },
              { "key": "x-timestamp", "value": "auto-generated" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"date_from\": \"2026-02-01T00:00:00.000Z\",\n  \"date_to\": \"2026-02-28T23:59:59.999Z\",\n  \"status\": \"CAPTURED\",\n  \"payment_mode\": \"CARD\",\n  \"page\": 1,\n  \"page_size\": 50\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{base_url}}/api/partner/pos-transactions",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-transactions"]
            },
            "description": "Filter transactions by status (CAPTURED) and payment mode (CARD)."
          },
          "response": [
            {
              "name": "200 â€” Captured Card Transactions",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"d4e5f6a7-b890-1234-cdef-567890abcdef\",\n      \"razorpay_txn_id\": \"260217042251974E883523117\",\n      \"external_ref\": \"EZ202602171503118508\",\n      \"terminal_id\": \"96192751\",\n      \"amount\": 285000,\n      \"status\": \"CAPTURED\",\n      \"rrn\": \"000000000070\",\n      \"card_brand\": \"VISA\",\n      \"card_type\": \"CREDIT\",\n      \"card_number\": \"4862-69XX-XXXX-3667\",\n      \"issuing_bank\": \"HDFC\",\n      \"card_classification\": \"PLATINUM\",\n      \"payment_mode\": \"CARD\",\n      \"settlement_status\": \"SETTLED\",\n      \"device_serial\": \"2841155771\",\n      \"customer_name\": \"MR SHREYAS T\",\n      \"payer_name\": \"MR SHREYAS T\",\n      \"username\": \"0096192751\",\n      \"txn_type\": \"CHARGE\",\n      \"auth_code\": \"007115\",\n      \"mid\": \"IDZ551\",\n      \"currency\": \"INR\",\n      \"receipt_url\": \"http://eze.cc/RZPPOS/t/a/DB120049\",\n      \"settled_on\": \"2026-02-01T01:00:00.000Z\",\n      \"posting_date\": \"2026-02-01T00:12:00.000Z\",\n      \"merchant_name\": \"Same Day Solution\",\n      \"txn_time\": \"2026-02-01T00:12:00.000Z\",\n      \"created_at\": \"2026-02-01T00:12:01.000Z\",\n      \"retailer_code\": \"RET001\",\n      \"retailer_name\": \"Example Retailer\"\n    },\n    {\n      \"id\": \"e5f6a7b8-9012-3456-def0-1234567890ab\",\n      \"razorpay_txn_id\": \"260217190219976R010026788\",\n      \"external_ref\": \"EZ202602171503224124\",\n      \"terminal_id\": \"96192751\",\n      \"amount\": 240000,\n      \"status\": \"CAPTURED\",\n      \"rrn\": \"000000000071\",\n      \"card_brand\": \"MasterCard\",\n      \"card_type\": \"CREDIT\",\n      \"card_number\": \"5334-67XX-XXXX-2745\",\n      \"issuing_bank\": \"AXIS\",\n      \"card_classification\": \"MPL\",\n      \"payment_mode\": \"CARD\",\n      \"settlement_status\": \"SETTLED\",\n      \"device_serial\": \"2841155771\",\n      \"customer_name\": \"THAKUR PRASAD\",\n      \"payer_name\": \"THAKUR PRASAD\",\n      \"username\": \"0096192751\",\n      \"txn_type\": \"CHARGE\",\n      \"auth_code\": \"162439\",\n      \"mid\": \"IDZ551\",\n      \"currency\": \"INR\",\n      \"receipt_url\": \"http://eze.cc/RZPPOS/t/a/AF224124\",\n      \"settled_on\": \"2026-02-01T01:00:00.000Z\",\n      \"posting_date\": \"2026-02-01T00:32:00.000Z\",\n      \"merchant_name\": \"Same Day Solution\",\n      \"txn_time\": \"2026-02-01T00:32:00.000Z\",\n      \"created_at\": \"2026-02-01T00:32:01.000Z\",\n      \"retailer_code\": \"RET001\",\n      \"retailer_name\": \"Example Retailer\"\n    }\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"page_size\": 50,\n    \"total_records\": 2,\n    \"total_pages\": 1,\n    \"has_next\": false,\n    \"has_prev\": false\n  },\n  \"summary\": {\n    \"total_transactions\": 2,\n    \"total_amount_paisa\": 525000,\n    \"total_amount_rupees\": \"5250.00\",\n    \"authorized_count\": 0,\n    \"captured_count\": 2,\n    \"failed_count\": 0,\n    \"refunded_count\": 0,\n    \"captured_amount_paisa\": 525000,\n    \"captured_amount_rupees\": \"5250.00\",\n    \"terminal_count\": 1\n  }\n}"
            }
          ]
        },
        {
          "name": "Get Assigned POS Machines",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "// GET request: empty body for signature",
                  "const signaturePayload = '' + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has machines array', function() {",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.success).to.be.true;",
                  "  pm.expect(json.data).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Response has pagination', function() {",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.pagination).to.be.an('object');",
                  "  pm.expect(json.pagination).to.have.property('total');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              { "key": "x-api-key", "value": "{{api_key}}", "description": "Your public API key (auto-set by pre-request script)" },
              { "key": "x-signature", "value": "auto-generated", "description": "HMAC-SHA256 signature (auto-set by pre-request script)" },
              { "key": "x-timestamp", "value": "auto-generated", "description": "Unix timestamp in ms (auto-set by pre-request script)" }
            ],
            "url": {
              "raw": "{{base_url}}/api/partner/pos-machines?page=1&limit=50",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-machines"],
              "query": [
                { "key": "page", "value": "1", "description": "Page number (default: 1)" },
                { "key": "limit", "value": "50", "description": "Records per page (default: 50, max: 100)" },
                { "key": "status", "value": "", "description": "Filter by status: active, inactive, maintenance, decommissioned", "disabled": true },
                { "key": "machine_type", "value": "", "description": "Filter by machine model (e.g., Razorpay POS)", "disabled": true },
                { "key": "search", "value": "", "description": "Search by terminal_id, device_serial, machine_model", "disabled": true }
              ]
            },
            "description": "Retrieve POS machines assigned to your partner account.\n\n### Query Parameters\n| Parameter | Type | Required | Description |\n|----------|------|----------|-------------|\n| `page` | Integer | No | Page number (default: 1) |\n| `limit` | Integer | No | Records per page (default: 50, max: 100) |\n| `status` | String | No | Filter by status: `active`, `inactive`, `maintenance`, `decommissioned` |\n| `machine_type` | String | No | Filter by machine model (e.g., `Razorpay POS`) |\n| `search` | String | No | Search by terminal_id, device_serial, machine_model |\n\n### Authentication Headers\n| Header | Description |\n|--------|-------------|\n| `x-api-key` | Your public API key |\n| `x-signature` | `HMAC_SHA256(api_secret, '' + timestamp)` (empty body for GET) |\n| `x-timestamp` | Current Unix timestamp in milliseconds |\n\n### Response Fields\nEach machine object includes:\n- `id`: Unique machine UUID\n- `terminal_id`: Razorpay Terminal ID (TID)\n- `device_serial`: Physical device serial number\n- `machine_model`: Machine model/type\n- `status`: Operational status (`active`, `inactive`, `maintenance`, `decommissioned`)\n- `activated_at`: When the machine was activated\n- `last_txn_at`: Timestamp of last transaction\n- `retailer_code`: Assigned retailer code\n- `retailer_name`: Assigned retailer name\n- `retailer_business_name`: Retailer business name\n- `retailer_city`, `retailer_state`: Retailer location"
          },
          "response": [
            {
              "name": "200 â€” Machines Found",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n      \"terminal_id\": \"29196333\",\n      \"device_serial\": \"2841154268\",\n      \"machine_model\": \"Razorpay POS\",\n      \"status\": \"active\",\n      \"activated_at\": \"2026-02-01T10:00:00.000Z\",\n      \"last_txn_at\": \"2026-02-18T04:22:51.000Z\",\n      \"metadata\": {},\n      \"created_at\": \"2026-02-01T10:00:00.000Z\",\n      \"updated_at\": \"2026-02-18T10:00:00.000Z\",\n      \"retailer_code\": \"RET001\",\n      \"retailer_name\": \"Example Retailer\",\n      \"retailer_business_name\": \"Example Retail Pvt Ltd\",\n      \"retailer_city\": \"new delhi\",\n      \"retailer_state\": \"delhi\"\n    }\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"limit\": 50,\n    \"total\": 1,\n    \"total_pages\": 1,\n    \"has_next_page\": false,\n    \"has_prev_page\": false\n  }\n}"
            },
            {
              "name": "200 â€” No Machines",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": [],\n  \"pagination\": {\n    \"page\": 1,\n    \"limit\": 50,\n    \"total\": 0,\n    \"total_pages\": 0,\n    \"has_next_page\": false,\n    \"has_prev_page\": false\n  }\n}"
            },
            {
              "name": "401 â€” Unauthorized",
              "status": "Unauthorized",
              "code": 401,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"UNAUTHORIZED\",\n    \"message\": \"Invalid API key\"\n  }\n}"
            }
          ]
        },
        {
          "name": "Create Export Job â€” CSV",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "const signaturePayload = JSON.stringify(body) + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Export job created', function() {",
                  "  pm.response.to.have.status(202);",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.data.job_id).to.be.a('string');",
                  "  // Save job_id for status check",
                  "  pm.collectionVariables.set('last_export_job_id', json.data.job_id);",
                  "  console.log('âœ“ Export job created. job_id saved:', json.data.job_id);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-api-key", "value": "{{api_key}}" },
              { "key": "x-signature", "value": "auto-generated" },
              { "key": "x-timestamp", "value": "auto-generated" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"format\": \"csv\",\n  \"date_from\": \"2026-02-01\",\n  \"date_to\": \"2026-02-28\",\n  \"status\": null,\n  \"terminal_id\": null\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{base_url}}/api/partner/pos-transactions/export",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-transactions", "export"]
            },
            "description": "Create an async export job in CSV format.\n\n### Supported Formats\n| Format | Description |\n|--------|-------------|\n| `csv` | Comma-separated values |\n| `excel` | Microsoft Excel (.xlsx) |\n| `pdf` | PDF report |\n| `zip` | ZIP archive with CSV + PDF |\n\n### Export Fields\nAll exported files include all transaction fields, including:\n- `card_classification` - Card tier/classification (PLATINUM, GOLD, SIGNATURE, etc.)\n- All other transaction fields as documented in the Get POS Transactions endpoint\n\n### Daily Limit\nDefault: 10 exports/day. Contact admin to increase.\n\n### Response\nReturns a `job_id` â€” use it in the Export Status endpoint to check progress."
          },
          "response": [
            {
              "name": "202 â€” Export Job Created",
              "status": "Accepted",
              "code": 202,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": {\n    \"message\": \"Export job created. Use the job_id to check status.\",\n    \"job_id\": \"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\n    \"format\": \"csv\",\n    \"status\": \"QUEUED\",\n    \"remaining_exports_today\": 9\n  }\n}"
            },
            {
              "name": "400 â€” Daily Export Limit Exceeded",
              "status": "Bad Request",
              "code": 400,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"BAD_REQUEST\",\n    \"message\": \"Daily export limit reached (10/10). Try again tomorrow.\"\n  }\n}"
            }
          ]
        },
        {
          "name": "Create Export Job â€” Excel",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "const signaturePayload = JSON.stringify(body) + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Export job created', function() {",
                  "  pm.response.to.have.status(202);",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.data.job_id).to.be.a('string');",
                  "  // Save job_id for status check",
                  "  pm.collectionVariables.set('last_export_job_id', json.data.job_id);",
                  "  console.log('âœ“ Export job created. job_id saved:', json.data.job_id);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-api-key", "value": "{{api_key}}" },
              { "key": "x-signature", "value": "auto-generated" },
              { "key": "x-timestamp", "value": "auto-generated" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"format\": \"excel\",\n  \"date_from\": \"2026-02-01\",\n  \"date_to\": \"2026-02-28\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{base_url}}/api/partner/pos-transactions/export",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-transactions", "export"]
            },
            "description": "Create an async export job in Excel (.xlsx) format.\n\n### Export Fields\nAll exported files include all transaction fields, including `card_classification` and all other fields as documented in the Get POS Transactions endpoint."
          },
          "response": []
        },
        {
          "name": "Create Export Job â€” ZIP",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "const signaturePayload = JSON.stringify(body) + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Export job created', function() {",
                  "  pm.response.to.have.status(202);",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.data.job_id).to.be.a('string');",
                  "  // Save job_id for status check",
                  "  pm.collectionVariables.set('last_export_job_id', json.data.job_id);",
                  "  console.log('âœ“ Export job created. job_id saved:', json.data.job_id);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-api-key", "value": "{{api_key}}" },
              { "key": "x-signature", "value": "auto-generated" },
              { "key": "x-timestamp", "value": "auto-generated" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"format\": \"zip\",\n  \"date_from\": \"2026-02-01\",\n  \"date_to\": \"2026-02-28\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{base_url}}/api/partner/pos-transactions/export",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "pos-transactions", "export"]
            },
            "description": "Create an async export job in ZIP format (contains CSV + PDF).\n\n### Export Fields\nAll exported files include all transaction fields, including `card_classification` and all other fields as documented in the Get POS Transactions endpoint."
          },
          "response": []
        },
        {
          "name": "Check Export Status",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const CryptoJS = require('crypto-js');",
                  "",
                  "// Get variables from collection (preferred) or environment (fallback)",
                  "let apiKey = pm.collectionVariables.get('api_key');",
                  "let apiSecret = pm.collectionVariables.get('api_secret');",
                  "",
                  "// Fallback to environment variables if collection variables not set",
                  "if (!apiKey) apiKey = pm.environment.get('api_key');",
                  "if (!apiSecret) apiSecret = pm.environment.get('api_secret');",
                  "",
                  "// Validate variables",
                  "if (!apiKey || apiKey.trim() === '' || apiKey === 'pk_live_YOUR_API_KEY_HERE') {",
                  "  throw new Error('Please set api_key in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "if (!apiSecret || apiSecret.trim() === '' || apiSecret === 'sk_live_YOUR_API_SECRET_HERE') {",
                  "  throw new Error('Please set api_secret in Collection Variables. Click collection name â†’ Variables tab');",
                  "}",
                  "",
                  "// Get job_id from collection variables (auto-saved from export job creation)",
                  "let jobId = pm.collectionVariables.get('last_export_job_id');",
                  "",
                  "// Fallback to environment variable if collection variable not set",
                  "if (!jobId || jobId.trim() === '') {",
                  "  jobId = pm.environment.get('last_export_job_id');",
                  "}",
                  "",
                  "// Validate job_id is present",
                  "if (!jobId || jobId.trim() === '' || jobId === '{{last_export_job_id}}') {",
                  "  throw new Error('job_id is required.\\n\\nSteps:\\n1. First, run \"Create Export Job â€” CSV\" (or Excel/ZIP)\\n2. The job_id will be automatically saved to last_export_job_id variable\\n3. Then run this request to check status\\n\\nOr manually set last_export_job_id in Collection Variables');",
                  "}",
                  "",
                  "// Validate UUID format (job_id should be a UUID)",
                  "const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;",
                  "if (!uuidRegex.test(jobId.trim())) {",
                  "  throw new Error('Invalid job_id format. Expected UUID format (e.g., f47ac10b-58cc-4372-a567-0e02b2c3d479).\\n\\nCurrent value: ' + jobId + '\\n\\nPlease run \"Create Export Job\" first to get a valid job_id.');",
                  "}",
                  "",
                  "const timestamp = Date.now().toString();",
                  "// GET request: empty body for signature",
                  "const signaturePayload = '' + timestamp;",
                  "const signature = CryptoJS.HmacSHA256(signaturePayload, apiSecret).toString(CryptoJS.enc.Hex);",
                  "pm.request.headers.upsert({ key: 'x-api-key', value: apiKey });",
                  "pm.request.headers.upsert({ key: 'x-signature', value: signature });",
                  "pm.request.headers.upsert({ key: 'x-timestamp', value: timestamp });",
                  "",
                  "console.log('Checking status for job_id:', jobId);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Job status returned', function() {",
                  "  const json = pm.response.json();",
                  "  pm.expect(json.data.job).to.have.property('status');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              { "key": "x-api-key", "value": "{{api_key}}" },
              { "key": "x-signature", "value": "auto-generated" },
              { "key": "x-timestamp", "value": "auto-generated" }
            ],
            "url": {
              "raw": "{{base_url}}/api/partner/export-status/{{last_export_job_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "partner", "export-status", "{{last_export_job_id}}"]
            },
            "description": "Check the status of an export job.\n\n### Path Parameter\n| Param | Description |\n|-------|-------------|\n| `job_id` | UUID returned from the Create Export endpoint |\n\n### Job Statuses\n| Status | Description |\n|--------|-------------|\n| `QUEUED` | Waiting in queue |\n| `PROCESSING` | Currently generating file |\n| `COMPLETED` | Ready for download |\n| `FAILED` | Export failed |\n\nWhen status is `COMPLETED`, the response includes a signed S3 download URL (valid for 1 hour)."
          },
          "response": [
            {
              "name": "200 â€” Job Completed",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": {\n    \"job\": {\n      \"id\": \"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\n      \"status\": \"COMPLETED\",\n      \"format\": \"csv\",\n      \"file_url\": \"https://sameday-pos-exports.s3.ap-south-1.amazonaws.com/exports/partner-xyz/2026-02-17_txns.csv?X-Amz-Signature=...\",\n      \"file_size_bytes\": 45670,\n      \"record_count\": 150,\n      \"created_at\": \"2026-02-17T10:00:00.000Z\",\n      \"completed_at\": \"2026-02-17T10:00:15.000Z\",\n      \"expires_at\": \"2026-02-17T11:00:15.000Z\"\n    }\n  }\n}"
            },
            {
              "name": "200 â€” Job Processing",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": {\n    \"job\": {\n      \"id\": \"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\n      \"status\": \"PROCESSING\",\n      \"format\": \"csv\",\n      \"file_url\": null,\n      \"created_at\": \"2026-02-17T10:00:00.000Z\",\n      \"completed_at\": null\n    }\n  }\n}"
            },
            {
              "name": "404 â€” Job Not Found",
              "status": "Not Found",
              "code": 404,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"NOT_FOUND\",\n    \"message\": \"Export job not found\"\n  }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "ðŸ§ª Webhook (Internal)",
      "description": "Razorpay POS Webhook endpoint. This is called automatically by Razorpay â€” not by partners.\n\nIncluded here for testing/debugging only.",
      "item": [
        {
          "name": "Simulate Razorpay POS Webhook",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"txnId\": \"260217093324974E883523117\",\n  \"tid\": \"96192751\",\n  \"amount\": 2850,\n  \"status\": \"AUTHORIZED\",\n  \"rrNumber\": \"000000000070\",\n  \"paymentMode\": \"CARD\",\n  \"paymentCardType\": \"CREDIT\",\n  \"paymentCardBrand\": \"VISA\",\n  \"postingDate\": \"2026-02-17T04:22:51.000+0000\",\n  \"settlementStatus\": \"PENDING\",\n  \"externalRefNumber\": \"EZ202602171503118508\",\n  \"deviceSerial\": \"2841155771\",\n  \"customerName\": \"MR SHREYAS T\",\n  \"payerName\": \"MR SHREYAS T\",\n  \"username\": \"0096192751\",\n  \"txnType\": \"CHARGE\",\n  \"authCode\": \"007115\",\n  \"cardNumber\": \"4862-69XX-XXXX-3667\",\n  \"issuingBankName\": \"HDFC\",\n  \"cardClassification\": \"PLATINUM\",\n  \"mid\": \"IDZ551\",\n  \"currencyCode\": \"INR\",\n  \"customerReceiptUrl\": \"http://eze.cc/RZPPOS/t/a/DB120049\",\n  \"merchantName\": \"Same Day Solution\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{base_url}}/api/webhook/razorpay-pos",
              "host": ["{{base_url}}"],
              "path": ["api", "webhook", "razorpay-pos"]
            },
            "description": "**For internal testing only.** Simulates a Razorpay POS webhook notification.\n\nIn production, this endpoint is called automatically by Razorpay when a POS transaction occurs."
          },
          "response": [
            {
              "name": "200 â€” Webhook Processed",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"data\": {\n    \"message\": \"Transaction processed\",\n    \"txnId\": \"260217093324974E883523117\",\n    \"action\": \"inserted\",\n    \"transaction_id\": \"b2c3d4e5-f6a7-8901-bcde-f12345678901\"\n  }\n}"
            }
          ]
        }
      ]
    }
  ]
}
